<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Unlock HQ • Whack‑a‑Mole</title>
  <link rel="icon" href="assets/unlockhq_web.png" />
  <style>
    :root{ --bg:#070b16; --ink:#e9ecff; --muted:#9aa3c7; --accent:#7cf3c8; --accent2:#6cc8ff; --card:#0e1633; --border:#1a2450; --good:#22c55e; --bad:#ef4444; --radius:16px; }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0; font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,Arial; color:var(--ink); background:radial-gradient(1000px 600px at 10% 10%,#0f1b3e 0%,#070b16 55%,#050812 100%) fixed; overflow-x:hidden}
    .wrap{max-width:980px; margin:0 auto; padding:18px}
    .card{background:linear-gradient(180deg,var(--card),#0a1129); border:1px solid var(--border); border-radius:var(--radius)}
    .pad{padding:18px}
    .muted{color:var(--muted)}

    header{position:sticky; top:0; z-index:10; border-bottom:1px solid var(--border); background:linear-gradient(180deg, rgba(7,11,22,.85), rgba(7,11,22,0)); backdrop-filter:saturate(130%) blur(6px)}
    #brand{display:flex; align-items:center; gap:12px}
    #brand img{height:46px; width:auto; filter:drop-shadow(0 0 12px rgba(124,243,200,.5))}

    .hero{display:grid; grid-template-columns:1fr auto; gap:14px; align-items:center}
    @media (max-width: 860px){ .hero{grid-template-columns:1fr} }

    .controls{display:flex; gap:8px; flex-wrap:wrap}
    .btn{background:linear-gradient(180deg,var(--accent),#4fd1b6); color:#02150f; font-weight:800; border:none; border-radius:12px; padding:10px 14px; cursor:pointer}
    select, .pill{height:40px; border-radius:999px; border:1px solid var(--border); background:#0b122c; color:var(--muted); padding:0 12px; font-weight:700}
    .hud{display:flex; gap:12px; flex-wrap:wrap}
    .pill strong{color:#bfefff}

    /* Board */
    .board-wrap{display:grid; grid-template-columns:1fr 300px; gap:16px; align-items:start}
    @media (max-width: 860px){ .board-wrap{grid-template-columns:1fr} }

    .board{--n:3; --gap:10px; --hole:94px; display:grid; gap:var(--gap); grid-template-columns:repeat(var(--n), var(--hole)); grid-auto-rows:var(--hole); justify-content:center; padding:12px; background:#0b122c; border:1px solid var(--border); border-radius:16px}
    @media (max-width:540px){ .board{ --hole:82px; } }

    .hole{position:relative; border-radius:50%; background:radial-gradient(circle at 35% 30%, #0f1733 0 40%, #0a132e 70%, #060a1e 100%); border:1px solid #27335d; overflow:hidden}
    .mole{position:absolute; left:50%; bottom:-10%; transform:translateX(-50%); width:72%; aspect-ratio:1/1; border-radius:50%; background:linear-gradient(180deg,#7cf3c8,#34d399); box-shadow:0 12px 30px rgba(124,243,200,.35); display:grid; place-items:center; font-weight:900; color:#06281d}
    .mole.hidden{display:none}
    .mole.bad{background:linear-gradient(180deg,#ffb4b4,#ff6b6b); color:#3a0a0a}
    .pop{animation:pop .12s ease-out}
    @keyframes pop{from{transform:translate(-50%,20%) scale(.9)} to{transform:translate(-50%,0) scale(1)}}

    .sidebar .panel{background:#0b122c; border:1px solid var(--border); border-radius:12px; padding:12px; margin-bottom:10px}
    progress{width:100%; height:10px}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="card pad hero">
        <div>
          <div id="brand"><img src="assets/unlockhq_web.png" alt="Unlock HQ"><h1 style="margin:0">Whack‑a‑Mole</h1></div>
          <p class="muted" style="margin:6px 0 10px">Tap the good moles, avoid the red decoys, and race the clock. Mobile‑friendly and fast.</p>
          <div class="hud">
            <span class="pill">Score: <strong id="score">0</strong></span>
            <span class="pill">Combo: <strong id="combo">0</strong></span>
            <span class="pill">Misses: <strong id="miss">0</strong></span>
            <span class="pill">Time: <strong id="time">00:30</strong></span>
          </div>
        </div>
        <div class="controls">
          <select id="mode">
            <option value="30">Classic : 30s</option>
            <option value="60">Endurance : 60s</option>
            <option value="endless">Endless</option>
          </select>
          <select id="difficulty">
            <option value="easy">Easy (3×3)</option>
            <option value="normal" selected>Normal (3×3)</option>
            <option value="hard">Hard (4×4)</option>
          </select>
          <button class="btn" id="start">Start</button>
          <button class="btn" id="pause">Pause</button>
          <button class="btn" id="reset">Reset</button>
        </div>
      </div>
    </div>
  </header>

  <main class="wrap">
    <div class="board-wrap">
      <div class="card pad" style="padding:12px">
        <div id="board" class="board" aria-label="game board"></div>
      </div>
      <aside class="sidebar">
        <div class="panel">
          <h3 style="margin:0 0 6px">How to play</h3>
          <ul class="muted" style="margin:0 0 0 18px">
            <li>Tap/click <strong>green moles</strong> for +1 (+combo bonus).</li>
            <li>Avoid <strong>red decoys</strong> (−2 and combo resets).</li>
            <li>Missed moles (+0) increase your <em>misses</em>.</li>
          </ul>
        </div>
        <div class="panel">
          <h3 style="margin:0 0 6px">Session</h3>
          <div class="muted" style="display:grid; grid-template-columns:1fr auto; gap:8px; align-items:center">
            <span>Time</span><progress id="prog" max="100" value="0"></progress>
            <span>Speed</span><span id="speed" class="pill">—</span>
          </div>
        </div>
        <div class="panel">
          <h3 style="margin:0 0 6px">Tips</h3>
          <ul class="muted" style="margin:0 0 0 18px">
            <li>On Hard, the board scales to 4×4 and moles pop faster.</li>
            <li>Endless never ends—go for a huge combo, then share your score.</li>
          </ul>
        </div>
      </aside>
    </div>
  </main>

  <footer class="wrap muted" style="text-align:center; margin:22px 0 30px">
    <small>© <span id="year"></span> Unlock HQ • Whack‑a‑Mole</small>
  </footer>

  <script>
    // ===== Simple sound using WebAudio (no files) =====
    const Sound = (()=>{
      let ctx; function beep(freq=600, dur=0.08, type='square', vol=0.05){
        ctx = ctx || new (window.AudioContext||window.webkitAudioContext)();
        const o=ctx.createOscillator(), g=ctx.createGain(); o.type=type; o.frequency.value=freq; g.gain.value=vol; o.connect(g); g.connect(ctx.destination); o.start(); setTimeout(()=>o.stop(), dur*1000);
      }
      return { good:()=>beep(760,0.07,'square',0.06), bad:()=>beep(220,0.12,'sawtooth',0.06), tick:()=>beep(420,0.03,'triangle',0.03) };
    })();

    // ===== Game state =====
    const $ = s=>document.querySelector(s);
    const boardEl = $('#board');
    const scoreEl=$('#score'), comboEl=$('#combo'), missEl=$('#miss'), timeEl=$('#time'), progEl=$('#prog'), speedEl=$('#speed');
    const modeSel=$('#mode'), diffSel=$('#difficulty');
    const startBtn=$('#start'), pauseBtn=$('#pause'), resetBtn=$('#reset');

    let N=3, holes=[], timer=null, running=false, remaining=30, mode='30', moleTimeout=0, tickInt=0, spawnDelay=700, hideDelay=900, combo=0, score=0, misses=0;

    function initBoard(){
      boardEl.innerHTML='';
      boardEl.style.setProperty('--n', N);
      holes = [];
      const total = N*N;
      for(let i=0;i<total;i++){
        const h=document.createElement('div'); h.className='hole';
        const m=document.createElement('button'); m.className='mole hidden'; m.setAttribute('aria-label','mole'); m.addEventListener('click',()=>whack(m));
        h.appendChild(m); boardEl.appendChild(h); holes.push({h,m,alive:false,bad:false});
      }
    }

    function setDifficulty(level){
      if(level==='easy'){ N=3; spawnDelay=800; hideDelay=950; }
      if(level==='normal'){ N=3; spawnDelay=650; hideDelay=850; }
      if(level==='hard'){ N=4; spawnDelay=520; hideDelay=720; }
      initBoard();
      speedEl.textContent = (1000/Math.max(300,spawnDelay)).toFixed(1)+ ' Hz';
    }

    function setMode(m){ mode=m; remaining = (m==='endless')? Infinity : Number(m); updateClock(); progEl.max = (m==='endless')? 1 : remaining; progEl.value = 0; }

    function updateClock(){ if(remaining===Infinity){ timeEl.textContent='∞'; } else { const m=Math.floor(remaining/60), s=remaining%60; timeEl.textContent=`${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`; } }

    function start(){ if(running) return; running=true; tick(); tickInt = setInterval(tick, Math.max(300, spawnDelay)); if(mode!=='endless'){ timer = setInterval(()=>{ remaining--; updateClock(); progEl.value = (progEl.max - remaining); if(remaining<=0) end(); }, 1000);} }
    function pause(){ if(!running) return; running=false; clearInterval(tickInt); clearInterval(timer); tickInt=0; timer=0; }
    function end(){ pause(); // reveal final
      Array.from(boardEl.querySelectorAll('.mole')).forEach(m=>m.classList.add('hidden'));
      alert(`Time!\nScore: ${score}\nCombo: ${combo}\nMisses: ${misses}`);
    }
    function reset(){ pause(); score=0; combo=0; misses=0; scoreEl.textContent=0; comboEl.textContent=0; missEl.textContent=0; setMode(modeSel.value); }

    function randomHole(){ return holes[Math.floor(Math.random()*holes.length)]; }

    function tick(){ if(!running) return; // spawn a mole
      const cell = randomHole(); if(cell.alive) return; // skip if already up
      const bad = Math.random()<0.18; // 18% decoys
      cell.bad = bad; cell.alive = true; const m=cell.m; m.classList.remove('hidden'); m.classList.toggle('bad', bad); m.classList.add('pop'); setTimeout(()=>m.classList.remove('pop'), 150);
      // auto hide
      const hideMs = hideDelay * (bad?0.85:1);
      moleTimeout = setTimeout(()=>{ if(cell.alive){ cell.alive=false; m.classList.add('hidden'); misses++; missEl.textContent=misses; combo=0; comboEl.textContent=0; } }, hideMs);
      // periodic tick sound
      Sound.tick();
    }

    function whack(m){
      // find its cell
      const idx = Array.from(boardEl.querySelectorAll('.mole')).indexOf(m);
      const cell = holes[idx];
      if(!cell || !cell.alive) return;
      cell.alive=false; m.classList.add('hidden');
      if(cell.bad){ // penalty
        Sound.bad();
        score = Math.max(0, score-2); combo=0;
      } else {
        Sound.good();
        combo = Math.min(999, combo+1); const bonus = Math.floor(Math.min(5, combo/5)); score += 1 + bonus;
      }
      scoreEl.textContent=score; comboEl.textContent=combo;
    }

    // UI wiring
    startBtn.addEventListener('click', start);
    pauseBtn.addEventListener('click', pause);
    resetBtn.addEventListener('click', reset);
    modeSel.addEventListener('change', e=> setMode(e.target.value));
    diffSel.addEventListener('change', e=> setDifficulty(e.target.value));

    // Init
    setDifficulty(diffSel.value); setMode(modeSel.value);
    document.getElementById('year').textContent = new Date().getFullYear();
  </script>
</body>
</html>
